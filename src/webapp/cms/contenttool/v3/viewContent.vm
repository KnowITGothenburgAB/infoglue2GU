#define( $headerMarkup )

	<link rel="stylesheet" type="text/css" href="css/cms.css" />
	<link rel="stylesheet" type="text/css" href="applications/jscalendar/skins/aqua/theme.css" />
	<script type="text/javascript" src="applications/jscalendar/calendar.js"></script>
	<script type="text/javascript" src="applications/jscalendar/lang/calendar-en.js"></script>
	<script type="text/javascript" src="applications/jscalendar/calendar-setup.js"></script>

	<script type="text/javascript">
	<!--
	
		function save()
		{
			document.editForm.submit();
		}
	-->
	</script>
#end

#beginLightCommonToolV3Impl("tool.contenttool.contentHeader" "$!contentId" "contentId=$!contentId" false true $!disableCloseButton $headerMarkup)

	##lightMenuToolbar("" $buttons $rightButtons) 

	<div style="clear: both;"></div>

	<form method="POST" name="editForm" action="UpdateContent!v3.action">
		<input type="hidden" name="contentId" value="$!contentId">
		<input type="hidden" name="isBranch" value="$!isBranch">
		<input type="hidden" name="unrefreshedContentId" value="$!contentId">
		<input type="hidden" name="repositoryId" value="$!repositoryId">
		<input type="hidden" name="changeTypeId" value="1">
		
		<div id="igEditArea" class="igScrollArea" onfocus="this.blur();">

				<p>
					#editTextFieldCSS("Content.name" "name" $formatter.escapeHTML($!name) "30" true false "longtextfield")
				</p>
				
				#if($enableDateTimeDirectEditing == "true")
					#set($dateReadonly = "")
				#else
					#set($dateReadonly = "readonly")
				#end
				
				<p>
					#editDateField("Content.publishDateTime" "publishDateTime" $!publishDateTime "30" "date" "ViewCalendar.action?date=$!publishDateTimeAsLong&formPath=document.editForm.publishDateTime" "$dateReadonly")
				</p>
				<p>
					#editDateField("Content.expireDateTime" "expireDateTime" $!expireDateTime "30" "date" "ViewCalendar.action?date=$!expireDateTimeAsLong&formPath=document.editForm.expireDateTime" "$dateReadonly")
				</p>		
			
				<p>
					$ui.getString("tool.contenttool.lastUpdatedByLabel") $contentVO.creatorName <br/>Content ID: $contentVO.id
				</p>

				<p> 
					#set($isProtectedReadonly = "")
					#set($protectedContentId = $!this.getProtectedContentId($contentId))
					#set($isModifier = ($contentVO.creatorName == $infoGluePrincipal.name))
					#if($protectedContentId && !$isModifier && !$this.hasAccessTo("Content.ChangeAccessRights", "$protectedContentId"))
						#set($isProtectedReadonly = "disabled")
						<input type="hidden" name="isProtected" value="$!isProtected"/> 
					#end
					$ui.getString("entity.Content.isProtected.label")<br>
					<input type="radio" name="isProtected" value="0" #if($!isProtected == 0) checked="1" #end $disabled $isProtectedReadonly> $ui.getString("tool.common.no") 
					<input type="radio" name="isProtected" value="1" #if($!isProtected == 1) checked="1" #end $disabled $isProtectedReadonly> $ui.getString("tool.common.yes")
					<input type="radio" name="isProtected" value="2" #if($!isProtected == 2) checked="1" #end $disabled $isProtectedReadonly> $ui.getString("tool.common.inherit")
				</p>		
				
				#if(!$contentVO.contentTypeDefinitionId)
				<p>
					$ui.getString("tool.contenttool.newContent.contentType")<br/>
					<select class="contenttypes" name="contentTypeDefinitionId">
					##if($isBranch)<option value="">Not defined yet</option>#end
					#foreach ($contentTypeDefinitionVO in $contentTypeDefinitions)
						#if($isBranch && $defaultFolderContentTypeName == $contentTypeDefinitionVO.getName())
							<option value="$contentTypeDefinitionVO.getContentTypeDefinitionId()" selected="1">$contentTypeDefinitionVO.getName()</option>
						#else
							<option value="$contentTypeDefinitionVO.getContentTypeDefinitionId()">$contentTypeDefinitionVO.getName()</option>
						#end
					#end
					</select>
				</p>
				#else
				<p>
					$ui.getString("tool.contenttool.contentTypeLabel") $contentTypeDefinition.getName()
				</p>			
				#end
							
				<h4>$ui.getString("tool.contenttool.contentVersionReferences.header")</h4>
				#set($hasContentReferences = false)
				#set($isOdd = true)
				#set($count = 0)
				#foreach ($referenceBean in $referenceBeanList)
					#if($referenceBean.referencingCompletingObject.class.name.indexOf("Content") > -1)
						#if($count < 20)
							#set($hasContentReferences = true)
							#set($lastIndex = $referenceBean.versions.size() - 1)
							#if($isOdd)
								#set($class = "class='lightgreen'")
								#set($isOdd = false)
							#else
								#set($class = "class='white'")
								#set($isOdd = true)
							#end
							<p $class>
								<img src="images/tree/contentRoot.gif" width="16" height="16"/>
								<a href="ViewContentVersion!standalone.action?contentId=$referenceBean.referencingCompletingObject.contentId&languageId=$referenceBean.versions.get($lastIndex).referencingObject.languageId" target="_blank">$referenceBean.name</a>
				 				- #if($referenceBean.versions.get($lastIndex).registryVOList.size() > 1) $referenceBean.versions.get($lastIndex).registryVOList.size() $ui.getString("tool.contenttool.referencesFound") #end ($referenceBean.versions.size() $ui.getString("tool.contenttool.versions"))
				 				<a href="ViewContentVersion!standalone.action?contentId=$referenceBean.referencingCompletingObject.contentId&languageId=$referenceBean.versions.get($lastIndex).referencingObject.languageId" target="_blank"><img src="images/edit.gif" border="0"></a>
							</p>
						#end
						#set($count = $count + 1)	
					#end
				#end
				#if($count > 20)
					#if($isOdd)
						#set($class = "class='lightgray'")
						#set($isOdd = false)
					#else
						#set($class = "class='white'")
						#set($isOdd = true)
					#end
					<p $class>
						<span style="color: red;">$ui.getString("tool.contenttool.moreContentReferencesFound") $count</span>		
					</p>	
				#end
				
				#if(!$hasContentReferences)
					<p $class>
						$ui.getString("tool.contenttool.noContentReferencesFound")	
					</p>	
				#end

				<h4>$ui.getString("tool.contenttool.siteNodeReferences.header")</h4>
			
				#set($hasPageReferences = false)
				#set($isOdd = true)
				#set($count = 0)
				#foreach ($referenceBean in $referenceBeanList)
					#if($referenceBean.referencingCompletingObject.class.name.indexOf("SiteNode") > -1)
						#if($count < 20)
							#set($hasPageReferences = true)
							#set($lastIndex = $referenceBean.versions.size() - 1)
							#if($isOdd)
								#set($class = "class='lightgray'")
								#set($isOdd = false)
							#else
								#set($class = "class='white'")
								#set($isOdd = true)
							#end
							<p $class>
								<img src="images/tree/structureRoot.gif">
								<a href="${componentRendererUrl}${componentRendererAction}?siteNodeId=$referenceBean.referencingCompletingObject.siteNodeId&contentId=-1" target="_blank">$referenceBean.name</a>
								- #if($referenceBean.versions.get($lastIndex).registryVOList.size() > 1) $referenceBean.versions.get($lastIndex).registryVOList.size() $ui.getString("tool.structuretool.referencesFound") #end ($referenceBean.versions.size() $ui.getString("tool.structuretool.versions"))
								<a href="${componentRendererUrl}${componentRendererAction}?siteNodeId=$referenceBean.referencingCompletingObject.siteNodeId&contentId=-1" target="_blank"><img src="images/edit.gif" border="0"></a>
							</p>	
						#end
						#set($count = $count + 1)
					#end
				#end
			
				#if($count > 20)
					#if($isOdd)
						#set($class = "class='lightgreen'")
						#set($isOdd = false)
					#else
						#set($class = "class='white'")
						#set($isOdd = true)
					#end
					<p $class>
						<span colspan="3" style="color: red;">$ui.getString("tool.contenttool.morePageReferencesFound") $count</span>		
					</p>	
				#end
			
				#if(!$hasPageReferences)
					<p $class>
						$ui.getString("tool.contenttool.noPageReferencesFound")		
					</p>	
				#end
				
		</div>
		
		#lightFooterToolbar($footerButtons)
		
	</form>
		

#endLightCommonToolV3()