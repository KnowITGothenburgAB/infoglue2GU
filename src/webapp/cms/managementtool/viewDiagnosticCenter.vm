<?xml version="1.0" encoding="UTF-8"?> 

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

#beginManagementTool("tool.managementtool.viewDiagnosticCenter.header" "tool.managementtool.viewDiagnosticCenter.header" "")

<div class="fullymarginalized" style="color: black;">

	<h3>$ui.getString("tool.managementtool.deliverApplicationState.header"):</h3>
	<h4>CMS:</h4>
	<a href="ViewApplicationState.action">infoglueCMS</a><br/>
	
	<h4>Working/Preview:</h4>
	#foreach($url in $internalDeliverUrls)
		<a href="$url/ViewApplicationState.action">$url</a><br/>
	#end
	
	<h4>Live:</h4>
	#foreach($url in $publicDeliverUrls)
		<a href="$url/ViewApplicationState.action">$url</a><br/>
	#end
	
	<h3>Statistics</h3>
	<p>
		Number of siteNodes: $numberOfSiteNodes<br />
		Number of siteNodeVersions: $numberOfSiteNodeVersions<br />
		Number of contents: $numberOfContents<br />
		Number of content versions: $numberOfContentVersions<br />
		Number of digitalAssets: $numberOfDigitalAssets<br />
		<br>
		Number of unused digitalAssets (could potentially be removed): $numberOfUnusedDigitalAssets<br />
		SQL to remove unused assets: <br><br>
		MySQL and SQLServer: 
		<p style="background-color: white; width: 600px; border: 1px solid black; padding: 4px; color: blue;">delete from cmDigitalAsset da where da.assetKey NOT LIKE '%portletentityregistry.xml%' AND da.assetContentType NOT LIKE '%application%' AND da.digitalAssetId not in (select digitalAssetId from cmContentVersionDigitalAsset) AND da.digitalAssetId not in (select digitalAssetId from cmGroupPropertiesDigitalAsset) AND da.digitalAssetId not in (select digitalAssetId from cmRolePropertiesDigitalAsset) AND da.digitalAssetId not in (select digitalAssetId from cmUserPropertiesDigitalAsset)</p><br/>
		Oracle: 
		<p style="background-color: white; width: 600px; border: 1px solid black; padding: 4px; color: blue;">delete from cmDigAsset da where da.assetKey NOT LIKE '%portletentityregistry.xml%' AND da.assetContentType NOT LIKE '%application%' AND da.digAssetId not in (select digAssetId from cmContVerDigAsset) AND da.digAssetId not in (select digAssetId from cmGroupPropDigAsset) AND da.digAssetId not in (select digAssetId from cmRolePropDigAsset) AND da.digAssetId not in (select digAssetId from cmUserPropDigAsset)</p><br/>
	</p>
		
#endManagementTool()
