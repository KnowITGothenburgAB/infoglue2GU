<?xml version="1.0" encoding="UTF-8"?> 

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html>
<head>
	<title>Choose component to add</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	
	<script type="text/javascript" language="JavaScript">
	<!-- 
	    function addComponent(componentId)
	    {
	    	//alert("siteNodeId: $siteNodeId");
	    	//alert("languageId: $languageId");
	    	//alert("parentComponentId: $!parentComponentId");
	    	//alert("contentId: $!contentId");
	    	//alert("$slotId: $slotId");
	    	//alert("componentId:" + componentId);
	    		
	    	url = "ViewSiteNodePageComponents!addComponent.action?siteNodeId=$siteNodeId&languageId=$languageId&contentId=$contentId&parentComponentId=$!parentComponentId&componentId=" + componentId + "&slotId=$slotId&specifyBaseTemplate=$!specifyBaseTemplate&showSimple=$showSimple";
		    //alert("url" + url);
	    	self.opener.location.href = url;
		    window.close();
	    }
	
		function changeRepository(selectBox)
		{
			var repositoryId = selectBox.value;
			var url = "ViewSiteNodePageComponents!listComponents.action?siteNodeId=$siteNodeId&languageId=$languageId&contentId=$contentId&parentComponentId=$!parentComponentId&slotId=$slotId&specifyBaseTemplate=$!specifyBaseTemplate&showSimple=$showSimple&filterRepositoryId=" + repositoryId;
			//alert("url:" + url);
			document.location.href = url;
		}
	
	-->
	</script>
	
	<link rel="stylesheet" type="text/css" href="css/cms.css" /> 
</head>

<body class="structuretooledit"  align="center">

#set($allRepositories = $repositories)

<table class="structuretooledit" cellpadding="0" cellspacing="0" border="0" width="100%" height="100%">
<tr>
	<td valign="top">
		
		<table cellpadding="0" cellspacing="0" border="0" align="center" width="100%">
		<tr>
			<td colspan="4"><img src="images/trans.gif" height="10"></td>
		</tr>
		<tr class="darkapricot">
			<td colspan="4" class="smalllabel">Click on the component you wish to add</td>
		</tr>
		<tr>
			<td colspan="4" height="1" bgcolor="#FEF8D0"><img src="images/trans.gif" width="1" height="1"></td>
		</tr>
		<tr>
			<td colspan="4" height="1" bgcolor="#F0E1B4"><img src="images/trans.gif" width="1" height="1"></td>
		</tr>
		<tr>
			<td colspan="4" height="1"><img src="images/trans.gif" width="1" height="15"></td>
		</tr>
		<tr>
			<td colspan="4">Change this to show other components located in another repository<br/>
		  		<select size="1" name="repositoryId" class="sitedropbox" onChange="javascript:changeRepository(this);" class="contenttool">
				    <option value="-1" #if($repositoryVO.id == $filterRepositoryId) selected="1" #end>All repositories</option>
				    #foreach ($repositoryVO in $allRepositories)
				    <option value="$repositoryVO.getRepositoryId()" #if($repositoryVO.id == $filterRepositoryId) selected="1" #end>$repositoryVO.getName()</option>
				    #end
				</select>
			</td>
		</tr>
		<tr>
			<td height="1"><img src="images/trans.gif" width="1" height="15"></td>
		</tr>	
		<tr style="background-color:#F0E1B4; height:20px;">
			<td height="1"><strong>Icon</strong></td>
			<td height="1">
				<strong><a href="ViewSiteNodePageComponents!listComponents.action?siteNodeId=$siteNodeId&languageId=$languageId&contentId=$contentId&specifyBaseTemplate=$!specifyBaseTemplate&parentComponentId=$parentComponentId&slotId=$slotId&filterRepositoryId=$filterRepositoryId&sortProperty=name&showSimple=$showSimple">Component Name</a></strong>
				#if($sortProperty == "name")<img src="images/downArrow.gif">#end
			</td>
			<td height="1">
				<strong><a href="ViewSiteNodePageComponents!listComponents.action?siteNodeId=$siteNodeId&languageId=$languageId&contentId=$contentId&specifyBaseTemplate=$!specifyBaseTemplate&parentComponentId=$parentComponentId&slotId=$slotId&filterRepositoryId=$filterRepositoryId&sortProperty=repositoryId&showSimple=$showSimple">Repository</a></strong>
				#if($sortProperty == "repositoryId")<img src="images/downArrow.gif">#end
			</td>
			#*
			<td height="1">
			<strong><a href="ViewSiteNodePageComponents!listComponents.action?siteNodeId=$siteNodeId&languageId=$languageId&contentId=$contentId&specifyBaseTemplate=$!specifyBaseTemplate&parentComponentId=$parentComponentId&slotId=$slotId&filterRepositoryId=$filterRepositoryId&sortProperty=id&showSimple=$showSimple">Id</a></strong>
				#if($sortProperty == "id")<img src="images/downArrow.gif">#end
			</td>
			*#
			<td height="1">
			<strong><a href="ViewSiteNodePageComponents!listComponents.action?siteNodeId=$siteNodeId&languageId=$languageId&contentId=$contentId&specifyBaseTemplate=$!specifyBaseTemplate&parentComponentId=$parentComponentId&slotId=$slotId&filterRepositoryId=$filterRepositoryId&sortProperty=GroupName&showSimple=$showSimple">GroupName</a></strong>
				#if($sortProperty == "GroupName")<img src="images/downArrow.gif">#end
			</td>
		</tr>
		<tr>
			<td colspan="4" height="1" bgcolor="#FEF8D0"><img src="images/trans.gif" width="1" height="1"></td>
		</tr>
		<tr>
			<td colspan="4" height="1" bgcolor="#F0E1B4"><img src="images/trans.gif" width="1" height="1"></td>
		</tr>
		#set($isOdd = true)
		#set($sortedComponents = $this.getSortedComponents($sortProperty))
		#foreach ($content in $sortedComponents)
			#if($filterRepositoryId == -1 || $content.repositoryId == $filterRepositoryId)
				#if($isOdd)
					#set($class = "class='lightapricot'")
					#set($isOdd = false)
				#else
					#set($class = "class='white'")
					#set($isOdd = true)
				#end
				
				#set($imageUrl = "images/componentIcon.gif")
				##set($imageUrl = $this.getDigitalAssetUrl($content.id, "thumbnail"))
				<tr $class>
					<td align="center"><a href="javascript:addComponent('$content.id');"><img src="$imageUrl" border="0"></a>&nbsp;</td>
					<td valign="middle"><a href="javascript:addComponent('$content.id');">$content.getName()</a></td>
					<td valign="middle">
						#foreach ($repositoryVO in $allRepositories)
					    	#if($repositoryVO.id == $content.repositoryId)
					    		$repositoryVO.getName()
					    	#end
					    #end
					</td>
					#*<td align="middle">$content.id</td>*#
					<td valign="middle">$content.extraProperties.get("GroupName")</td>
				</tr>	
				#set($imageUrl = "")
			#end
		#end
		
		<tr>
			<td colspan="4">&nbsp;</td>
		</tr>
		<tr>
			<td colspan="4"><a href="javascript:window.close();"><img src="$ui.getString("images.structuretool.buttons.cancel")" border="0"></a></td>
		</tr>
		</table>
	</td>	
</tr>
</table>

</body>
</html>
